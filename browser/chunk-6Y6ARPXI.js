import{a as ye,b as Ce}from"./chunk-ZPV4GNWT.js";import{b as he}from"./chunk-LFGIHUEI.js";import{b as ge}from"./chunk-VQHYYTZD.js";import{a as _e,e as ve,g as fe}from"./chunk-IFEE7RF4.js";import"./chunk-ZDGAUC7Z.js";import{a as de}from"./chunk-MUOSKTGI.js";import"./chunk-RXRC2IAU.js";import{c as Y,e as u,f as Z,g as ee,h as te,k as ie,l as oe,m as ne,n as re,o as le,p as ae,q as pe,r as se,t as me,u as ce,v as ue}from"./chunk-DO327FSU.js";import{$ as B,A as q,Z as $,aa as k,ba as H,ca as Q,fa as j,ga as U,ha as J,ia as W,la as K,qa as X,w as M,x as G,y as L,z as R}from"./chunk-W7O4NI74.js";import"./chunk-RXWOWTKC.js";import{d as P,e as V,j as A,w as T,y as z,z as w}from"./chunk-H4Z643GT.js";import{Ac as s,Bc as S,Cc as _,Rb as m,Sb as l,Tb as n,Ub as g,Za as a,cc as F,ic as h,ka as y,kb as D,la as C,lc as c,pb as O,vb as v,vc as b}from"./chunk-G573C4CW.js";import"./chunk-AQY5CCQG.js";function Fe(o,i){if(o&1&&(l(0,"mat-chip"),s(1),n()),o&2){let e,t=c(2).$implicit;a(),_("Style : ",(e=t.get("style"))==null?null:e.value)}}function be(o,i){if(o&1&&(l(0,"mat-chip"),s(1),n()),o&2){let e,t=c(2).$implicit;a(),_("Color : ",(e=t.get("color"))==null?null:e.value)}}function Ie(o,i){if(o&1&&(l(0,"mat-chip"),s(1),n()),o&2){let e,t=c(2).$implicit;a(),_("Size : ",(e=t.get("size"))==null?null:e.value)}}function Ee(o,i){if(o&1&&(l(0,"mat-chip"),s(1),n()),o&2){let e,t=c(2).$implicit;a(),_("Quantity : ",(e=t.get("quantity"))==null?null:e.value)}}function Ne(o,i){if(o&1&&(l(0,"mat-chip"),s(1),n()),o&2){let e,t=c(2).$implicit;a(),_("PO Rate : ",(e=t.get("poRate"))==null?null:e.value)}}function Oe(o,i){if(o&1&&(l(0,"mat-chip"),s(1),n()),o&2){let e,t=c(2).$implicit;a(),_("Gmts : ",(e=t.get("popl"))==null?null:e.value)}}function Pe(o,i){if(o&1&&(l(0,"mat-chip"),s(1),n()),o&2){let e,t=c(2).$implicit;a(),_("PO Value : ",(e=t.get("poValue"))==null?null:e.value)}}function Ve(o,i){if(o&1){let e=F();l(0,"button",14),h("click",function(){y(e),c();let p=b(2);return C(p.toggleItem())}),l(1,"div")(2,"div")(3,"span"),s(4),n()(),l(5,"div"),v(6,Fe,2,1,"mat-chip",15)(7,be,2,1,"mat-chip",15)(8,Ie,2,1,"mat-chip",15)(9,Ee,2,1,"mat-chip",15)(10,Ne,2,1,"mat-chip",15)(11,Oe,2,1,"mat-chip",15)(12,Pe,2,1,"mat-chip",15),n()()()}if(o&2){let e,t,p,r,d,I,E,N=c(),f=N.$implicit,De=N.index,Se=b(2);m("collapsed",!Se.visible),a(4),_("PO Quantity ",De+1),a(2),m("ngIf",(e=f.get("style"))==null?null:e.value),a(),m("ngIf",(t=f.get("color"))==null?null:t.value),a(),m("ngIf",(p=f.get("size"))==null?null:p.value),a(),m("ngIf",(r=f.get("quantity"))==null?null:r.value),a(),m("ngIf",(d=f.get("poRate"))==null?null:d.value),a(),m("ngIf",(I=f.get("popl"))==null?null:I.value),a(),m("ngIf",(E=f.get("poValue"))==null?null:E.value)}}function Ae(o,i){if(o&1&&(l(0,"option",29),s(1),n()),o&2){let e=i.$implicit;m("value",e.style),a(),S(e.style)}}function Te(o,i){if(o&1&&(l(0,"option",29),s(1),n()),o&2){let e=i.$implicit;m("value",e.color),a(),S(e.color)}}function ze(o,i){if(o&1&&(l(0,"option",29),s(1),n()),o&2){let e=i.$implicit;m("value",e.size),a(),S(e.size)}}function we(o,i){if(o&1){let e=F();l(0,"div",16)(1,"div",17)(2,"div",18)(3,"c-input-group")(4,"span",19),s(5,"PO"),n(),g(6,"input",20),n()(),l(7,"div",18)(8,"c-input-group")(9,"span",19),s(10,"Style"),n(),l(11,"select",21),h("change",function(){y(e);let p=c().index,r=c();return C(r.getStyleId(p))}),l(12,"option"),s(13,"Select Style"),n(),v(14,Ae,2,2,"option",22),n()()(),l(15,"div",18)(16,"c-input-group")(17,"span",19),s(18,"Color"),n(),l(19,"select",23),h("change",function(){y(e);let p=c().index,r=c();return C(r.getColorId(p))}),l(20,"option"),s(21,"Select Color"),n(),v(22,Te,2,2,"option",22),n()()(),l(23,"div",18)(24,"c-input-group")(25,"span",19),s(26,"Size"),n(),l(27,"select",24),h("change",function(){y(e);let p=c().index,r=c();return C(r.getSizeId(p))}),l(28,"option"),s(29,"Select Size"),n(),v(30,ze,2,2,"option",22),n()()(),l(31,"div",18)(32,"c-input-group")(33,"span",19),s(34,"Quantity"),n(),g(35,"input",25),n()(),l(36,"div",18)(37,"c-input-group")(38,"span",19),s(39,"PO Rate"),n(),g(40,"input",26),n()(),l(41,"div",18)(42,"c-input-group")(43,"span",19),s(44,"PO Value"),n(),g(45,"input",27),n()(),l(46,"div",18)(47,"c-input-group")(48,"span",19),s(49,"Gmts Process Loss"),n(),g(50,"input",28),n()()()()}if(o&2){let e=c(2);a(14),m("ngForOf",e.styleList),a(8),m("ngForOf",e.colorList),a(8),m("ngForOf",e.sizeList)}}function Me(o,i){if(o&1&&(l(0,"div",10)(1,"c-accordion-item",11,0),v(3,Ve,13,9,"ng-template",12)(4,we,51,3,"ng-template",13),n()()),o&2){let e=i.index;m("formGroupName",e),a(),m("visible",!1)}}function Ge(o,i){if(o&1){let e=F();l(0,"div",3)(1,"button",30),h("click",function(){y(e);let p=c();return C(p.saveUpdate(1))}),s(2,"Save changes"),n()()}}var x=class x{constructor(i,e,t,p){this.router=i;this.fb=e;this.api=t;this.route=p;this.page=1;this.pageSize=5;this.styleList=[];this.colorList=[];this.sizeList=[];this.styleFilter="";this.colorFilter="";this.sizeFilter="";this.poDetailsForm=this.fb.group({id:[null],data:this.fb.array([])})}ngOnInit(){this.poNum=this.route.snapshot.paramMap.get("ponum"),this.poId=this.route.snapshot.paramMap.get("id"),this.title=`Purchase Number : ${this.poNum}`,this.styleListFn(),this.colorListFn(),this.listSizeFn(),this.callEdit(this.poId)}get fval(){return this.poDetailsForm.controls}get items(){return this.poDetailsForm.get("data")}addPODateils(){let i=this.fb.group({id:[null],orderNo:[this.poNum,[u.required]],orderId:[parseInt(this.poId),[u.required]],style:[null,[u.required]],styleId:[null,[u.required]],color:[null,[u.required]],colorId:[null,[u.required]],size:[null,[u.required]],sizeId:[null,[u.required]],quantity:[null,[u.required]],poValue:[null,[u.required]],poRate:[null,[u.required]],popl:[null,[u.required]]});this.items.push(i),i.get("quantity")?.valueChanges.subscribe(()=>{this.calculateDiff()}),i.get("poRate")?.valueChanges.subscribe(()=>{this.calculateDiff()})}styleListFn(){this.api.GetApi(`/mastersapi/style-master-filter?style=${this.styleFilter}`).subscribe(i=>{this.styleList=i.styles})}colorListFn(){this.api.GetApi(`/mastersapi/color-master-filter?color=${this.colorFilter}&`).subscribe(i=>{this.colorList=i.colors})}listSizeFn(){this.api.GetApi(`/mastersapi/size-master-filter?size=${this.sizeFilter}`).subscribe(i=>{this.sizeList=i.sizes})}getStyleId(i){let t=this.poDetailsForm.get("data").at(i),p=t.get("style")?.value,r=this.styleList.find(d=>d.style===p);r&&(t.get("styleId")?.setValue(r?.id),t.get("style")?.setValue(r?.style))}getColorId(i){let t=this.poDetailsForm.get("data").at(i),p=t.get("color")?.value,r=this.colorList.find(d=>d.color===p);r&&(t.get("colorId")?.setValue(r?.id),t.get("color")?.setValue(r?.color))}getSizeId(i){let t=this.poDetailsForm.get("data").at(i),p=t.get("size")?.value,r=this.sizeList.find(d=>d.size===p);r&&(t.get("sizeId")?.setValue(r?.id),t.get("size")?.setValue(r?.size))}calculateDiff(){this.items.controls.forEach(i=>{let e=i;if(e instanceof te){let t=parseFloat(e.get("quantity")?.value),p=parseFloat(e.get("poRate")?.value);if(t&&p){let r=t*p,d=parseFloat(r.toFixed(2))??0;e.patchValue({poValue:d})}else e.patchValue({poValue:0})}})}saveUpdate(i){this.poDetailsForm.invalid||i===1&&(this.poDetailsForm.controls.id.setValue(parseInt(this.poId)),this.api.PostApiWithHeader("/mastersapi/po-master_line",this.poDetailsForm.value).subscribe(e=>{e.success===!0?(this.router.navigate(["/pages/master/purchaseOrder/purchaseOrderMst"]),this.api.showSuccess("saved Successfully !!! ","Saved")):this.api.showError("Not saved","Error")}))}callEdit(i){this.api.GetApi(`/mastersapi/po-master-line/${i}`).subscribe(e=>{let t=e.po,p=this.poDetailsForm.get("data");p.clear(),t.forEach(r=>{let d=this.fb.group({id:r.id,orderNo:r.orderNo,orderId:r.orderId,style:r.style,styleId:r.styleId,color:r.color,colorId:r.colorId,size:r.size,sizeId:r.sizeId,quantity:r.quantity,poValue:r.poValue,poRate:r.poRate,popl:r.popl});p.push(d)})})}};x.\u0275fac=function(e){return new(e||x)(D(z),D(me),D(de),D(T))},x.\u0275cmp=O({type:x,selectors:[["app-po-details"]],decls:15,vars:4,consts:[["item0","cAccordionItem"],["fluid",""],[3,"routerLink"],[1,"ms-auto"],["cButton","","color","primary","variant","outline",3,"click"],[2,"overflow-x","auto","width","100%",3,"formGroup"],["formArrayName","data"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"bg-light","text-center","p-2"],["class","ms-auto",4,"ngIf"],[3,"formGroupName"],[3,"visible"],["cTemplateId","accordionHeaderTemplate"],["cTemplateId","accordionBodyTemplate"],["cAccordionButton","",3,"click","collapsed"],[4,"ngIf"],[1,"accordion-body"],[1,"row","mb-3"],[1,"col-md-6","mb-3"],["cInputGroupText",""],["aria-label","PO","cFormControl","","placeholder","Enter PO","formControlName","orderNo","readonly",""],["aria-label","Style","cSelect","","formControlName","style",3,"change"],[3,"value",4,"ngFor","ngForOf"],["aria-label","Color","cSelect","","formControlName","color",3,"change"],["aria-label","Size","cSelect","","formControlName","size",3,"change"],["aria-label","Quantity","cFormControl","","placeholder","Enter Quantity","formControlName","quantity","type","number"],["aria-label","PO Rate","cFormControl","","placeholder","Enter PO Rate","formControlName","poRate","type","number"],["aria-label","PO Value","cFormControl","","placeholder","Enter PO Value","formControlName","poValue","readonly","","type","number"],["aria-label","Gmts Process Loss","cFormControl","","placeholder","Enter Gmts Process Loss","formControlName","popl","type","number"],[3,"value"],["cButton","","color","primary",3,"click"]],template:function(e,t){e&1&&(l(0,"c-header")(1,"c-container",1)(2,"c-header-brand",2),s(3),n(),l(4,"c-header-nav",3)(5,"c-nav-item")(6,"button",4),h("click",function(){return t.addPODateils()}),s(7,"Add"),n()()()(),g(8,"c-header-divider"),l(9,"c-container",1)(10,"div",5)(11,"c-accordion",6),v(12,Me,5,2,"div",7),n()()()(),l(13,"footer",8),v(14,Ge,3,0,"div",9),n()),e&2&&(a(3),S(t.title),a(7),m("formGroup",t.poDetailsForm),a(2),m("ngForOf",t.items.controls),a(2),m("ngIf",t.items.length>0))},dependencies:[K,j,U,J,W,w,Q,X,q,M,ue,pe,se,Y,ie,ae,Z,ee,oe,le,ne,re,B,k,H,$,A,P,V,he,ge,fe,_e,ve,ce,G,L,R,Ce,ye],encapsulation:2});var xe=x;export{xe as PODetailsComponent};
