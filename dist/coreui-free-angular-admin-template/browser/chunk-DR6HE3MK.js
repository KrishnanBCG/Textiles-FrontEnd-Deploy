import{a as Le}from"./chunk-YVX2SLF2.js";import{a as Ve,b as Be}from"./chunk-DJFYXFDX.js";import{b as Me}from"./chunk-VTW2WYXB.js";import{b as Ye}from"./chunk-MV7IGZFE.js";import{a as ke,b as Te,c as Ae,d as Fe,e as Ne}from"./chunk-3CQKJCQS.js";import{Qa as ge}from"./chunk-37HNLNO6.js";import"./chunk-GR7IJ7CP.js";import{a as Ee}from"./chunk-LBW5AWSH.js";import"./chunk-UZYPASHM.js";import{b as fe,c as ye,e as b,f as Ce,g as he,l as xe,m as Se,n as be,o as De,t as Re,u as Ie,v as we}from"./chunk-SVEOW7D2.js";import{$ as ie,A as q,B as U,Da as ve,G as W,H as X,L as J,M as Z,X as ee,_ as te,aa as ne,da as re,ea as oe,fa as ae,ga as ce,ia as le,na as pe,oa as me,pa as de,qa as se,ra as ue,ta as _e,u as H,v as z,w as O,x as $,y as P,z as K}from"./chunk-37SJZKTR.js";import"./chunk-CZ6YIH4Q.js";import{A as j,d as M,e as V,i as B,k as L,x as Q,z as G}from"./chunk-25OLHFVP.js";import{$b as y,Ic as N,Kc as Y,Ob as p,Pb as t,Qb as i,Rb as s,Vb as f,Xa as l,bb as x,bc as d,hb as E,ja as _,ka as v,la as w,lc as S,nb as g,qc as o,rc as u,sc as D,tc as k,uc as T,vc as A,wc as F}from"./chunk-AONHZWD2.js";import{a as R,b as I}from"./chunk-AQY5CCQG.js";function He(a,n){if(a&1){let e=f();t(0,"tr")(1,"td",26),o(2),i(),t(3,"td",26),o(4),i(),t(5,"td",26),o(6),i(),t(7,"td",26),o(8),N(9,"date"),i(),t(10,"td",26),o(11),i(),t(12,"td",26),o(13),i(),t(14,"td",26),o(15),i(),t(16,"td",26),o(17),i(),t(18,"td",26)(19,"button",27),y("click",function(){let c=_(e).$implicit,m=d(2);return v(m.ReceiptOpen(c))}),o(20," Yarn QC "),i()()()}if(a&2){let e=n.$implicit,r=n.index,c=d(2);l(2),u((c.page-1)*c.pageSize+r+1),l(2),u(e.spinningChallan),l(2),u(e.scandexChallan),l(2),u(Y(9,9,e.receiptDt,"dd/MM/yyyy")),l(3),u(e.knitFactory),l(2),u(e.BagsCtnNos),l(2),u(e.receiptYarnKgs||"-"),l(2),u(e.pendingReceiptKgs||"-"),l(2),p("cModalToggle","YarnQC")}}function ze(a,n){if(a&1){let e=f();t(0,"div",20)(1,"table",21)(2,"thead")(3,"tr")(4,"th",22),o(5,"Sl.No"),i(),t(6,"th",22),o(7,"Spin Challan"),i(),t(8,"th",22),o(9,"SBDL Challan"),i(),t(10,"th",22),o(11,"Receipt Dt"),i(),t(12,"th",22),o(13,"Knit Factory"),i(),t(14,"th",22),o(15,"Bags/Ctn - nos"),i(),t(16,"th",22),o(17,"Receipt Yarn Kgs"),i(),t(18,"th",22),o(19,"Pending Receipts - Kgs"),i(),t(20,"th",22),o(21,"Yarn QC"),i()()(),t(22,"tbody"),g(23,He,21,12,"tr",23),i()(),t(24,"div",24)(25,"ngb-pagination",25),F("pageChange",function(c){_(e);let m=d();return A(m.page,c)||(m.page=c),v(c)}),i()()()}if(a&2){let e=d();l(),p("striped",!0),l(22),p("ngForOf",e.yarnReceiptList==null?null:e.yarnReceiptList.slice((e.page-1)*e.pageSize,e.page*e.pageSize)),l(2),T("page",e.page),p("boundaryLinks",!0)("maxSize",3)("pageSize",e.pageSize)("collectionSize",e.yarnReceiptList.length)}}function Oe(a,n){a&1&&(t(0,"div",28)(1,"c-card",29),s(2,"img",30),t(3,"c-card-body")(4,"h5",31),o(5,"No Data Found"),i(),t(6,"p",32),o(7," There are no yarn Order Allocations records available at the moment. "),i()()()())}function $e(a,n){if(a&1&&(t(0,"mat-chip"),o(1),i()),a&2){let e=n.ngIf;l(),k(" Check Date: ",e.day,"/",e.month,"/",e.year," ")}}function Pe(a,n){if(a&1&&(t(0,"mat-chip"),o(1),i()),a&2){let e,r=d(2).$implicit;l(),D(" Results :",(e=r.get("checkResults"))==null?null:e.value," ")}}function Ke(a,n){if(a&1&&(t(0,"mat-chip"),o(1),i()),a&2){let e,r=d(2).$implicit;l(),D(" Status :",(e=r.get("yarnAcceptRejectStatus"))!=null&&e.value?"Accept":"Reject"," ")}}function qe(a,n){if(a&1){let e=f();t(0,"button",40),y("click",function(){_(e),d();let c=S(3);return v(c.toggleItem())}),t(1,"div")(2,"div")(3,"span"),o(4),i()(),t(5,"div"),g(6,$e,2,3,"mat-chip",41)(7,Pe,2,1,"mat-chip",41)(8,Ke,2,1,"mat-chip",41),i()()()}if(a&2){let e,r,c,m=d(),h=m.$implicit,Ge=m.index,je=S(3);p("collapsed",!je.visible),l(4),D("Quality control No ",Ge+1),l(2),p("ngIf",(e=h.get("checkDate"))==null?null:e.value),l(),p("ngIf",(r=h.get("checkResults"))==null?null:r.value),l(),p("ngIf",(c=h.get("yarnAcceptRejectStatus"))==null?null:c.value)}}function Ue(a,n){if(a&1){let e=f();t(0,"div",42)(1,"div",43)(2,"div",44)(3,"c-input-group")(4,"div",45)(5,"div")(6,"span",46),o(7,"Check Date"),i()(),t(8,"div",47)(9,"div",48),s(10,"input",49,2),t(12,"button",50),y("click",function(){_(e);let c=S(11);return v(c.toggle())}),s(13,"i",51),i()()()()()(),t(14,"div",44)(15,"c-input-group")(16,"span",46),o(17,"Results"),i(),s(18,"textarea",52),i()(),t(19,"div",53)(20,"c-input-group")(21,"div",54),s(22,"input",55),i(),t(23,"span",46),o(24,"Accept / Reject"),i()()()(),t(25,"div",56)(26,"div",26)(27,"button",57),y("click",function(){_(e);let c=d().index,m=d(2);return v(m.removeYarnQCItem(c))}),w(),s(28,"svg",58),i()()()()}if(a&2){let e=d(3);l(28),p("cIcon",e.icons.cilXCircle)}}function We(a,n){if(a&1&&(t(0,"div",36)(1,"c-accordion")(2,"c-accordion-item",37,1),g(4,qe,9,5,"ng-template",38)(5,Ue,29,1,"ng-template",39),i()()()),a&2){let e=n.index;p("formGroupName",e),l(2),p("visible",!1)}}function Xe(a,n){if(a&1&&(t(0,"div",33)(1,"div",34),g(2,We,6,2,"div",35),i()()),a&2){let e=d();l(2),p("ngForOf",e.items.controls)}}function Je(a,n){a&1&&(t(0,"div",28)(1,"c-card",29),s(2,"img",30),t(3,"c-card-body")(4,"h5",31),o(5,"No Data Found"),i(),t(6,"p",32),o(7," There are no Receipt records available at the moment. "),i()()()())}function Ze(a,n){if(a&1){let e=f();t(0,"button",59),y("click",function(){_(e);let c=d();return v(c.updateReceipt())}),o(1," Update changes "),i()}}var C=class C{constructor(n,e,r,c){this.router=n;this.route=e;this.fb=r;this.api=c;this.yarnReceiptList=[];this.page=1;this.pageSize=5;this.listKnit=[];this.yarnReceiptId=0;this.icons={cilXCircle:ge};this.colors=[{color:"light"}];this.yarnAllocatedYarnKgs=0;this.yarnQCForm=this.fb.group({yarnId:[],data:this.fb.array([])})}ngOnInit(){let n=this.route.snapshot.paramMap.get("EditLine");this.editId=n?parseInt(n,10):null,this.callEdit(this.editId)}convertNgbDateStruct(n){let e=new Date(n);return{year:e.getUTCFullYear(),month:e.getUTCMonth()+1,day:e.getUTCDate()}}formatDateValue(n){if(!n)return null;if(n.year&&n.month&&n.day){let e=n.year,r=String(n.month).padStart(2,"0"),c=String(n.day).padStart(2,"0");return`${e}-${r}-${c}`}if(n instanceof Date){let e=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),c=String(n.getDate()).padStart(2,"0");return`${e}-${r}-${c}`}return n}callEdit(n){this.api.GetApi(`/yarnapi/yarn/${n}`).subscribe(e=>{this.yarnReceiptList=e.yarn_receipts_lines,this.yarnAllData=e})}get items(){return this.yarnQCForm.get("data")}AddYarnQC(){let n=this.fb.group({id:[null],yarnReceiptId:[null,[b.required]],checkDate:[null,[b.required]],checkResults:[null,[b.required]],yarnAcceptRejectStatus:[null,[b.required]]});this.items.push(n)}removeYarnQCItem(n){this.items.removeAt(n)}ReceiptOpen(n){this.yarnReceiptId=n.id,this.api.GetApi(`/yarnapi/yarnReceiptForQC?id=${this.yarnAllData?.yarn[0]?.id}&receiptId=${this.yarnReceiptId}`).subscribe(e=>{let r=e.yarnQc,c=this.yarnQCForm.get("data");c.clear(),r.forEach(m=>{let h=this.fb.group({id:m.id,yarnReceiptId:this.yarnReceiptId,checkDate:this.convertNgbDateStruct(m.checkDate),checkResults:m.checkResults,yarnAcceptRejectStatus:m.yarnAcceptRejectStatus});c.push(h)})})}updateReceipt(){let n=this.yarnQCForm.value,e={yarnId:this.yarnAllData?.yarn[0]?.id,data:n.data.map(r=>I(R({},r),{checkDate:this.formatDateValue(r.checkDate),yarnReceiptId:this.yarnReceiptId}))};this.api.PostApiWithHeader("/yarnapi/yarn_quality_check",e).subscribe(r=>{r.success===!0?this.api.showSuccess("Updated Successfully !!! ","Saved"):this.api.showError("Not saved","Error")})}};C.\u0275fac=function(e){return new(e||C)(x(G),x(Q),x(Re),x(Ee))},C.\u0275cmp=E({type:C,selectors:[["app-yarn-receipt"]],decls:31,vars:8,consts:[["YarnQC",""],["item0","cAccordionItem"],["d01","ngbDatepicker"],["fluid",""],[3,"routerLink"],[1,"ms-auto"],["style","overflow-x: auto; width: 100%;","class","table-responsive",4,"ngIf"],["class","d-flex justify-content-center align-items-center","style","height: 100vh; width: 100%;",4,"ngIf"],["id","YarnQC","backdrop","static","scrollable","",3,"fullscreen"],["fluid","",1,"d-flex","justify-content-between","align-items-center","py-2"],["routerLink","/",1,"fw-bold","fs-5"],["cButton","","color","primary","variant","outline",3,"click"],[1,"cil-plus","me-1"],["cButtonClose","",3,"cModalToggle"],["fluid","",3,"formGroup"],[1,"container"],["class","row g-5",4,"ngIf"],[1,"d-flex","justify-content-between"],[1,"w-100","text-center"],["cButton","","color","primary",3,"click",4,"ngIf"],[1,"table-responsive",2,"overflow-x","auto","width","100%"],["bordered","","cTable","",1,"table","table-hover",3,"striped"],["scope","col",1,"text-center"],[4,"ngFor","ngForOf"],[2,"display","flex","justify-content","center"],[3,"pageChange","page","boundaryLinks","maxSize","pageSize","collectionSize"],[1,"text-center"],[1,"btn","btn-sm","btn-outline-primary",3,"click","cModalToggle"],[1,"d-flex","justify-content-center","align-items-center",2,"height","100vh","width","100%"],[2,"max-width","400px","text-align","center"],["cCardImg","top","src","../../../../assets/No data-amico.svg","alt","No Data"],["cCardTitle",""],["cCardText",""],[1,"row","g-5"],["formArrayName","data"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],[3,"visible"],["cTemplateId","accordionHeaderTemplate"],["cTemplateId","accordionBodyTemplate"],["cAccordionButton","",3,"click","collapsed"],[4,"ngIf"],[1,"accordion-body"],[1,"row","g-3","mb-4"],[1,"col-sm"],[2,"display","flex","flex-direction","row","width","inherit"],["cInputGroupText",""],[2,"width","100%"],[1,"input-group"],["placeholder","yyyy-mm-dd","name","d01","ngbDatepicker","","container","body","formControlName","checkDate",1,"form-control"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"cil-calendar"],["aria-label","Results","cFormControl","","formControlName","checkResults"],[1,"col-sm","d-flex","align-items-center"],[1,"input-group-text"],["type","checkbox","formControlName","yarnAcceptRejectStatus",1,"form-check-input","mt-0"],[1,"row","g-3","mb-12"],["cButton","","color","link",2,"color","red",3,"click"],["size","xl","title","List Icon",3,"cIcon"],["cButton","","color","primary",3,"click"]],template:function(e,r){if(e&1){let c=f();t(0,"c-header")(1,"c-container",3)(2,"c-header-brand",4),o(3,"Yarn Quality control List"),i(),s(4,"c-header-nav",5),i(),s(5,"c-header-divider"),t(6,"c-container",3),g(7,ze,26,7,"div",6)(8,Oe,8,0,"div",7),i()(),t(9,"c-modal",8,0)(11,"c-modal-header")(12,"c-container",9)(13,"c-header-brand",10),o(14," Yarn Quality control "),i(),t(15,"c-header-nav")(16,"c-nav-item")(17,"button",11),y("click",function(){return _(c),v(r.AddYarnQC())}),s(18,"i",12),o(19," Add "),i(),s(20,"button",13),i()()()(),t(21,"c-modal-body")(22,"div")(23,"c-header")(24,"c-container",14)(25,"div",15),g(26,Xe,3,1,"div",16)(27,Je,8,0,"div",7),i()()()()(),t(28,"c-modal-footer",17)(29,"div",18),g(30,Ze,2,0,"button",19),i()()()}if(e&2){let c=S(10);l(7),p("ngIf",((r.yarnReceiptList==null?null:r.yarnReceiptList.length)||0)>0),l(),p("ngIf",((r.yarnReceiptList==null?null:r.yarnReceiptList.length)||0)===0),l(),p("fullscreen",!0),l(11),p("cModalToggle",c.id),l(4),p("formGroup",r.yarnQCForm),l(2),p("ngIf",((r.items==null?null:r.items.length)||0)>0),l(),p("ngIf",((r.items==null?null:r.items.length)||0)===0),l(3),p("ngIf",((r.items==null?null:r.items.length)||0)>0)}},dependencies:[j,W,X,Z,J,q,le,re,oe,ae,ce,Le,z,H,ne,pe,O,ve,U,me,_e,se,ue,de,we,ye,fe,Ce,he,xe,De,Se,be,te,ie,ee,L,M,V,B,Me,Ye,Ne,Fe,ke,Ae,Te,Ie,$,P,K,Be,Ve],encapsulation:2});var Qe=C;export{Qe as YarnReceiptComponent};
