import{a as De}from"./chunk-QQERHAXB.js";import{a as Se,b as he}from"./chunk-ZPV4GNWT.js";import{b as be}from"./chunk-LFGIHUEI.js";import{b as xe}from"./chunk-VQHYYTZD.js";import{a as _e,d as ge,e as Ce,g as ye}from"./chunk-IFEE7RF4.js";import{Ka as ee}from"./chunk-5V6T3QYL.js";import"./chunk-ZDGAUC7Z.js";import{a as fe}from"./chunk-MUOSKTGI.js";import"./chunk-RXRC2IAU.js";import{c as te,e as s,f as ie,g as ne,h as A,k as re,l as oe,m as ae,n as le,o as me,p as ce,q as pe,r as de,t as se,u as ue,v as ve}from"./chunk-DO327FSU.js";import{$,A as q,Z as O,aa as P,ba as j,ca as X,fa as z,ga as J,ha as U,ia as W,la as Q,qa as Z,u as M,v as G,w as R,x as K,y as B,z as H}from"./chunk-W7O4NI74.js";import"./chunk-RXWOWTKC.js";import{d as w,e as I,j as N,w as V,y as L,z as k}from"./chunk-H4Z643GT.js";import{Ac as r,Bc as F,Cc as x,Kc as Y,Rb as c,Sb as i,Tb as t,Ub as d,Za as m,cc as D,ic as g,ka as f,kb as S,la as _,lc as v,ma as E,pb as T,vb as y,vc as h}from"./chunk-G573C4CW.js";import"./chunk-AQY5CCQG.js";function Ee(o,n){if(o&1&&(i(0,"option",34),r(1),t()),o&2){let e=n.$implicit;c("value",Y(e.spinfty)),m(),F(e.spinfty)}}function Te(o,n){if(o&1&&(i(0,"mat-chip"),r(1),t()),o&2){let e,a=v(2).$implicit;m(),x("Yarn Type : ",(e=a.get("yarnType"))==null?null:e.value)}}function we(o,n){if(o&1&&(i(0,"mat-chip"),r(1),t()),o&2){let e,a=v(2).$implicit;m(),x("LC Yarn Kgs : ",(e=a.get("lcYarnKgs"))==null?null:e.value)}}function Ie(o,n){if(o&1&&(i(0,"mat-chip"),r(1),t()),o&2){let e,a=v(2).$implicit;m(),x("Yarn Rate : ",(e=a.get("yarnRate"))==null?null:e.value)}}function Ne(o,n){if(o&1&&(i(0,"mat-chip"),r(1),t()),o&2){let e,a=v(2).$implicit;m(),x("LC Value : ",(e=a.get("yarnValue"))==null?null:e.value)}}function Ve(o,n){if(o&1){let e=D();i(0,"button",39),g("click",function(){f(e),v();let l=h(3);return _(l.toggleItem())}),i(1,"div")(2,"div")(3,"span"),r(4),t()(),i(5,"div"),y(6,Te,2,1,"mat-chip",40)(7,we,2,1,"mat-chip",40)(8,Ie,2,1,"mat-chip",40)(9,Ne,2,1,"mat-chip",40),t()()()}if(o&2){let e,a,l,p,u=v(),C=u.$implicit,Ye=u.index,Ae=h(3);c("collapsed",!Ae.visible),m(4),x("Yarn Line ",Ye+1),m(2),c("ngIf",(e=C.get("yarnType"))==null?null:e.value),m(),c("ngIf",(a=C.get("lcYarnKgs"))==null?null:a.value),m(),c("ngIf",(l=C.get("yarnRate"))==null?null:l.value),m(),c("ngIf",(p=C.get("yarnValue"))==null?null:p.value)}}function Le(o,n){if(o&1&&(i(0,"option",34),r(1),t()),o&2){let e=n.$implicit;c("value",Y(e.yarnType)),m(),F(e.yarnType)}}function ke(o,n){if(o&1){let e=D();i(0,"div",10)(1,"div",11)(2,"div",12)(3,"c-input-group")(4,"span",13),r(5,"Yarn Type"),t(),i(6,"select",41)(7,"option"),r(8,"Select"),t(),y(9,Le,2,3,"option",15),t()()(),i(10,"div",12)(11,"c-input-group")(12,"span",13),r(13,"LC Yarn Kgs"),t(),d(14,"input",42),t()(),i(15,"div",12)(16,"c-input-group")(17,"span",13),r(18,"Yarn Rate"),t(),d(19,"input",43),t()(),i(20,"div",12)(21,"c-input-group")(22,"span",13),r(23,"LC Value"),t(),d(24,"input",44),t()()(),i(25,"div",45)(26,"div",46)(27,"button",47),g("click",function(){f(e);let l=v().index,p=v();return _(p.removeItem(l))}),E(),d(28,"svg",48),t()()()()}if(o&2){let e=v(2);m(9),c("ngForOf",e.yarnTypeList),m(19),c("cIcon",e.icons.cilXCircle)}}function Me(o,n){if(o&1&&(i(0,"div",35)(1,"c-accordion")(2,"c-accordion-item",36,2),y(4,Ve,10,6,"ng-template",37)(5,ke,29,2,"ng-template",38),t()()()),o&2){let e=n.index;c("formGroupName",e),m(2),c("visible",!1)}}var b=class b{constructor(n,e,a,l){this.router=n;this.fb=e;this.api=a;this.route=l;this.icons={cilXCircle:ee};this.colors=[{color:"light"}];this.newYarnForm=this.fb.group({spinner:[null,[s.required]],lcDate:[null,[s.required]],lcNo:[null,[s.required]],pi:[null,[s.required]],piDate:[null,[s.required]],lcYarnKgs:[null,[s.required]],lcValue:[null,[s.required]],yarnStatus:[null,[s.required]],data:this.fb.array([])})}get items(){return this.newYarnForm.get("data")}AddLines(){let n=this.fb.group({yarnType:[null,[s.required]],lcYarnKgs:[null,[s.required]],yarnRate:[null,[s.required]],yarnValue:[null,[s.required]]});this.items.push(n),n.get("lcYarnKgs")?.valueChanges.subscribe(()=>{this.calculateDiff01()}),n.get("yarnRate")?.valueChanges.subscribe(()=>{this.calculateDiff02()}),n.get("yarnValue")?.valueChanges.subscribe(()=>{this.calculateDiff01()})}removeItem(n){this.items.removeAt(n)}calculateDiff01(){let n=0,e=0;this.items.controls.forEach(a=>{let l=a;if(l instanceof A){let p=parseFloat(l.get("lcYarnKgs")?.value)||0,u=parseFloat(l.get("yarnValue")?.value)||0;n+=p,e+=u,this.newYarnForm.get("lcYarnKgs")?.setValue(n),this.newYarnForm.get("lcValue")?.setValue(e)}})}calculateDiff02(){let n=0,e=0;this.items.controls.forEach(a=>{let l=a;if(l instanceof A){let p=parseFloat(l.get("lcYarnKgs")?.value)||0,u=parseFloat(l.get("yarnRate")?.value)||0,C=p*u;l.get("yarnValue")?.setValue(C)}})}ngOnInit(){this.loadSpinFtyList(),this.loadYarnTypeList()}loadSpinFtyList(){this.api.GetApi("/yarnapi/spinfty").subscribe(n=>{this.spinFtyList=n.buyers})}loadYarnTypeList(){this.api.GetApi("/yarnapi/yarn_type").subscribe(n=>{this.yarnTypeList=n.types})}dateFormat(n){let e=n==="lcDate"?this.newYarnForm.get("lcDate")?.value:this.newYarnForm.get("piDate")?.value;if(!e)return null;let a=e.year,l=String(e.month).padStart(2,"0"),p=String(e.day).padStart(2,"0");return`${a}-${l}-${p}`}saveYarn(){this.newYarnForm.controls.lcDate.setValue(this.dateFormat("lcDate")),this.newYarnForm.controls.piDate.setValue(this.dateFormat("piDate")),this.api.PostApiWithHeader("/yarnapi/yarn",this.newYarnForm.value).subscribe(n=>{n.success===!0?(this.newYarnForm.reset(),this.api.showSuccess("saved Successfully !!! ","Saved"),this.router.navigateByUrl("/pages/yarn/yarnList")):this.api.showError("Not saved","Error")})}};b.\u0275fac=function(e){return new(e||b)(S(L),S(se),S(fe),S(V))},b.\u0275cmp=T({type:b,selectors:[["app-yarn-add-edit"]],decls:87,vars:3,consts:[["d","ngbDatepicker"],["d01","ngbDatepicker"],["item0","cAccordionItem"],["fluid",""],[3,"routerLink"],[1,"ms-auto"],["cButton","","color","primary","variant","outline",3,"click"],["fluid","",3,"formGroup"],[1,"container"],[1,"row","g-5"],[1,"accordion-body"],[1,"row","g-3","mb-4"],[1,"col-sm"],["cInputGroupText",""],["aria-label","Spin Fty","cSelect","","formControlName","spinner"],[3,"value",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","row","width","inherit"],[2,"width","100%"],[1,"input-group"],["placeholder","yyyy-mm-dd","name","dp","ngbDatepicker","","container","body","formControlName","lcDate",1,"form-control"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"cil-calendar"],["aria-label","LC no","cFormControl","","formControlName","lcNo"],["aria-label","PI","cFormControl","","formControlName","pi"],["placeholder","yyyy-mm-dd","name","dp","ngbDatepicker","","container","body","formControlName","piDate",1,"form-control"],["aria-label","LC Yarn Kgs","cFormControl","","readonly","","formControlName","lcYarnKgs"],["aria-label","LC Value","cFormControl","","readonly","","formControlName","lcValue"],["aria-label","Status","cSelect","","formControlName","yarnStatus"],["value","open"],["value","close"],["formArrayName","data"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"bg-light","text-center","p-2"],["cButton","","color","primary",3,"click"],[3,"value"],[3,"formGroupName"],[3,"visible"],["cTemplateId","accordionHeaderTemplate"],["cTemplateId","accordionBodyTemplate"],["cAccordionButton","",3,"click","collapsed"],[4,"ngIf"],["aria-label","Yarn Type","cSelect","","formControlName","yarnType"],["aria-label","LC Yarn Kgs","cFormControl","","type","number","formControlName","lcYarnKgs"],["aria-label","Yarn Rate","cFormControl","","type","number","formControlName","yarnRate"],["aria-label","LC Value","cFormControl","","readonly","","formControlName","yarnValue"],[1,"row","g-3","mb-12"],[1,"text-center"],["cButton","","color","link",2,"color","red",3,"click"],["size","xl","title","List Icon",3,"cIcon"]],template:function(e,a){if(e&1){let l=D();i(0,"div")(1,"c-header")(2,"c-container",3)(3,"c-header-brand",4),r(4,"Yarn Add"),t(),i(5,"c-header-nav",5)(6,"c-nav-item")(7,"button",6),g("click",function(){return f(l),_(a.AddLines())}),r(8,"Add"),t()()()(),d(9,"c-header-divider"),i(10,"c-container",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",11)(15,"div",12)(16,"c-input-group")(17,"span",13),r(18,"Spin Fty"),t(),i(19,"select",14)(20,"option"),r(21,"Select"),t(),y(22,Ee,2,3,"option",15),t()()(),i(23,"div",12)(24,"c-input-group")(25,"div",16)(26,"div")(27,"span",13),r(28,"LC Date"),t()(),i(29,"div",17)(30,"div",18),d(31,"input",19,0),i(33,"button",20),g("click",function(){f(l);let u=h(32);return _(u.toggle())}),d(34,"i",21),t()()()()()(),i(35,"div",12)(36,"c-input-group")(37,"span",13),r(38,"LC no"),t(),d(39,"input",22),t()()(),i(40,"div",11)(41,"div",12)(42,"c-input-group")(43,"span",13),r(44,"PI"),t(),d(45,"input",23),t()(),i(46,"div",12)(47,"c-input-group")(48,"div",16)(49,"div")(50,"span",13),r(51,"PI Date"),t()(),i(52,"div",17)(53,"div",18),d(54,"input",24,1),i(56,"button",20),g("click",function(){f(l);let u=h(55);return _(u.toggle())}),d(57,"i",21),t()()()()()(),i(58,"div",12)(59,"c-input-group")(60,"span",13),r(61,"LC Yarn Kgs"),t(),d(62,"input",25),t()()(),i(63,"div",11)(64,"div",12)(65,"c-input-group")(66,"span",13),r(67,"LC Value"),t(),d(68,"input",26),t()(),i(69,"div",12)(70,"c-input-group")(71,"span",13),r(72,"Status"),t(),i(73,"select",27)(74,"option"),r(75,"Select"),t(),i(76,"option",28),r(77,"Open"),t(),i(78,"option",29),r(79,"Close"),t()()()()()()(),i(80,"div",9)(81,"div",30),y(82,Me,6,2,"div",31),t()()()()(),i(83,"footer",32)(84,"div",5)(85,"button",33),g("click",function(){return f(l),_(a.saveYarn())}),r(86," Save changes "),t()()()()}e&2&&(m(10),c("formGroup",a.newYarnForm),m(12),c("ngForOf",a.spinFtyList),m(60),c("ngForOf",a.items.controls))},dependencies:[k,q,Q,z,J,U,W,De,G,M,X,Z,R,ve,pe,de,te,re,ce,ie,ne,oe,me,ae,le,$,P,j,O,N,w,I,be,xe,ye,_e,Ce,ge,ue,K,B,H,he,Se],encapsulation:2});var Fe=b;export{Fe as YarnAddComponent};
